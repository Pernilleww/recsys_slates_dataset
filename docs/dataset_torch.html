---

title: dataset_torch


keywords: fastai
sidebar: home_sidebar

summary: "Module to load the slates dataset into a Pytorch Dataset and Dataloaders with default train/valid test splits."
description: "Module to load the slates dataset into a Pytorch Dataset and Dataloaders with default train/valid test splits."
nb_path: "dataset_torch.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: dataset_torch.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="SequentialDataset" class="doc_header"><code>class</code> <code>SequentialDataset</code><a href="https://github.com/finn-no/recsys_slates_dataset/tree/main/recsys_slates_dataset/dataset_torch.py#L15" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>SequentialDataset</code>(<strong>*<code>args</code></strong>, <strong>**<code>kwds</code></strong>) :: <code>Dataset</code></p>
</blockquote>
<p>A Pytorch Dataset for the FINN Recsys Slates Dataset.
Attributes:
  data: [Dict] A dictionary with tensors of the dataset. First dimension in each tensor must be the batch dimension. Requires the keys "click" and "slate". Additional elements can be added.
  sample_candidate_items: [Bool] If true, the dataset provide an additional dictionary item "allitem". This datapoint is uniformly random negative examples on the same size of the slate dataset. Often also called uniform candidate sampling. See Eide et. al. 2021 for more information.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="load_dataloaders" class="doc_header"><code>load_dataloaders</code><a href="https://github.com/finn-no/recsys_slates_dataset/tree/main/recsys_slates_dataset/dataset_torch.py#L59" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>load_dataloaders</code>(<strong><code>data_dir</code></strong>=<em><code>'dat'</code></em>, <strong><code>batch_size</code></strong>=<em><code>1024</code></em>, <strong><code>num_workers</code></strong>=<em><code>0</code></em>, <strong><code>sample_candidate_items</code></strong>=<em><code>False</code></em>, <strong><code>valid_pct</code></strong>=<em><code>0.05</code></em>, <strong><code>test_pct</code></strong>=<em><code>0.05</code></em>, <strong><code>t_testsplit</code></strong>=<em><code>5</code></em>, <strong><code>seed</code></strong>=<em><code>0</code></em>)</p>
</blockquote>
<p>Loads pytorch dataloaders to be used in training. If used with standard settings, the train/val/test split is equivalent to Eide et. al. 2021.</p>
<p>Attributes:
  data_dir: [str] where download and store data if not already downloaded.
  batch_size: [int] Batch size given by dataloaders.
  num_workers: [int] How many threads should be used to prepare batches of data.
  sample_candidate_items: [Bool] If true, the dataset provide an additional dictionary item "allitem". This datapoint is uniformly random negative examples on the same size of the slate dataset. Often also called uniform candidate sampling. See Eide et. al. 2021 for more information.
  valid_pct: [float] Percentage of users allocated to validation dataset.
  test_pct: [float] Percentage of users allocated to test dataset.
  t_testsplit: [int] For users allocated to validation and test datasets, how many initial interactions should be part of the training dataset.
  seed: [int] Seed used to sample users/items.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ind2val</span><span class="p">,</span> <span class="n">itemattr</span><span class="p">,</span> <span class="n">dataloaders</span> <span class="o">=</span> <span class="n">load_dataloaders</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2021-08-13 10:15:07,665 Download data if not in data folder..
2021-08-13 10:15:07,666 Downloading data.npz
2021-08-13 10:15:07,667 Downloading ind2val.json
2021-08-13 10:15:07,667 Downloading itemattr.npz
2021-08-13 10:15:07,668 Done downloading all files.
2021-08-13 10:15:07,668 Load data..
2021-08-13 10:15:31,565 Loading dataset with slate size=torch.Size([2277645, 20, 25]) and uniform candidate sampling=False
2021-08-13 10:15:31,834 Loading dataset with slate size=torch.Size([2277645, 20, 25]) and uniform candidate sampling=False
2021-08-13 10:15:31,839 Loading dataset with slate size=torch.Size([113882, 20, 25]) and uniform candidate sampling=False
2021-08-13 10:15:31,844 Loading dataset with slate size=torch.Size([113882, 20, 25]) and uniform candidate sampling=False
2021-08-13 10:15:31,845 In train: num_users: 2277645, num_batches: 2225
2021-08-13 10:15:31,846 In valid: num_users: 113882, num_batches: 112
2021-08-13 10:15:31,846 In test: num_users: 113882, num_batches: 112
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

